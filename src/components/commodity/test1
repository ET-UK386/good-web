<template>
  <div>
    商品信息
    <!-- 根据商品名或者分类查询 -->
    <div id="div">
      书名:<el-input
        v-model="skuName"
        placeholder="商品名"
        style="width: 150px; margin-left: 10px; margin-right: 10px"
      ></el-input>
      分类:<el-input
        v-model="sortName"
        placeholder="请输入分类"
        style="width: 150px; margin-left: 10px; margin-right: 10px"
      ></el-input>


      <!--<el-button type="primary" @click="search">查询</el-button>-->


      <el-button
        type="primary"
        style="margin-left: 30px"
        @click="dialogFormVisible = true"
        >新增</el-button
      >
    </div>

    <!-- 商品信息展示 -->
    <el-table :data="goodskus" stripe style="width: 100%">
      <el-table-column prop="skuName" label="商品名" width="120   ">
      </el-table-column>
      <el-table-column prop="skuDesc" label="商品描述" width="95">
      </el-table-column>
      <el-table-column prop="goodspu.brand" label="品牌商" width="80">
      </el-table-column>
      <el-table-column prop="goodspu.statusStr" label="上架状态" width="80">
      </el-table-column>
      <el-table-column prop="sort.sortName" label="所属分类" width="95">
      </el-table-column>
      <el-table-column prop="color.colorName" label="颜色" width="80">
      </el-table-column>
      <el-table-column prop="price.price" label="价格" width="80">
      </el-table-column>
      <el-table-column prop="user.username" label="创建人" width="80">
      </el-table-column>
      <el-table-column prop="createTime" label="创建时间" width="100">
      </el-table-column>
      <el-table-column prop="user.userRenewName" label="修改人" width="95">
      </el-table-column>
      <el-table-column prop="renewTime" label="修改时间" width="100">
      </el-table-column>
      <el-table-column label="操作" width="180">
        <template slot-scope="scope">
          <el-button
            icon="el-icon-search"
            circle
            @click="serachForAll(scope.row)"
          ></el-button>
          <el-button
            type="primary"
            icon="el-icon-edit"
            circle
            @click="edit(scope.row)"
          ></el-button>
          <el-button
            type="danger"
            icon="el-icon-delete"
            @click="del(scope.row)"
            circle
          ></el-button>
        </template>
      </el-table-column>
    </el-table>

    <!-- 新增 -->
    <el-dialog title="新增商品" :visible.sync="dialogFormVisible">
      <el-form :model="goodsku">
        <el-form-item hidden label="id" :label-width="formLabelWidth">
          <el-input v-model="goodsku.id" readonly="readonly" autocomplete="off">
          </el-input>
        </el-form-item>
        <el-form-item
          label="商品名"
          :label-width="formLabelWidth"
          prop="goodName"
        >
          <el-select v-model="goodsku.spuId" placeholder="请输入商品名">
            <el-option
              v-for="item in goodspus"
              :key="item.id"
              :label="item.goodName"
              :value="item.id"
            ></el-option>
          </el-select>
        </el-form-item>
        <el-form-item
          label="商品描述"
          :label-width="formLabelWidth"
          prop="skuDesc"
        >
          <el-input v-model="goodsku.skuDesc" autocomplete="off"></el-input>
        </el-form-item>
        <el-form-item
          label="价格"
          :label-width="formLabelWidth"
          prop="price.price"
        >
          <el-input v-model="goodsku.price.price" autocomplete="off"></el-input>
        </el-form-item>
        <el-form-item
          label="颜色"
          :label-width="formLabelWidth"
          prop="colorName"
        >
          <el-select v-model="goodsku.colorId" placeholder="请选择颜色">
            <el-option
              v-for="item in colors"
              :key="item.id"
              :label="item.colorName"
              :value="item.id"
            ></el-option>
          </el-select>
          <el-button plain @click="dialogFormVisible3 = true"
            >其它颜色</el-button
          >
        </el-form-item>
        <el-form-item
          label="所属分类"
          :label-width="formLabelWidth"
          prop="sort.sortName"
        >
          <el-select v-model="goodsku.sortId" placeholder="请选择分类">
            <el-option
              v-for="item in sorts"
              :key="item.id"
              :label="item.sortName"
              :value="item.id"
            ></el-option>
          </el-select>
          <el-button plain @click="dialogFormVisible4 = true"
            >其它分类</el-button
          >
        </el-form-item>
        <el-form-item
          label="单位"
          :label-width="formLabelWidth"
          prop="units.unitsName"
        >
          <el-select v-model="goodsku.companyId" placeholder="请选择单位">
            <el-option
              v-for="item in unitss"
              :key="item.id"
              :label="item.unitsName"
              :value="item.id"
            ></el-option>
          </el-select>
          <el-button plain @click="dialogFormVisible5 = true"
            >其它单位</el-button
          >
        </el-form-item>
        
        <el-form-item
          label="生产商"
          :label-width="formLabelWidth"
          prop="goodspu.brand"
        >
          <el-input
            v-model="goodsku.goodspu.brand"
            autocomplete="off"
          ></el-input>
        </el-form-item>
      </el-form>
      <div slot="footer" class="dialog-footer">
        <el-button @click="dialogFormVisible = false">取 消</el-button>
        <el-button type="primary" @click="add">确 定</el-button>
      </div>
    </el-dialog>
  </div>
</template>

<script>
export default {
  methods: {

    add(){
      console.log(this.goodsku);
    },

    // 查询商品信息
    list() {
      this.axios
        .get("http://localhost:8088/goodsku/listGoodsku")
        .then((response) => {
          if (response.status === 200) {
            // console.log(response.data)
            // console.log(response.data[3]);
            this.goodskus = response.data;
            this.goodskutwos = response.data;
            this.total = response.data.count;
          }
        });
    },
      listGoodSpus(){
      this.axios.get("http://localhost:8088/goodsku/listGoodSpus").then((response)=>{
        let data = response.data;
        if(response.status === 200){
          this.goodspus = data;
            
        }
      })
    },
    
    listColor(){
      this.axios.get("http://localhost:8088/goodsku/listColor").then((response)=>{
        let data = response.data;
        if(response.status === 200){
          this.colors = data;
        }
      })
    },
    listSort(){
      this.axios.get("http://localhost:8088/goodsku/listSort").then((response)=>{
        let data = response.data;
        if(response.status === 200){
           this.sorts = data;
        }
      })
    },
    listUnits(){
      this.axios.get("http://localhost:8088/goodsku/listUnits").then((response)=>{
        let data = response.data;
        if(response.status === 200){
          this.unitss = data;
        }
      })
    },
  },
  data() {
    return {
      skuName: "",
      sortName: "",
      goodskus: [],
      dialogFormVisible: false,
      dialogFormVisible3:false,
      formLabelWidth:'120px',
      goodsku: {
        price:{},
        goodspu:{}
      },
      goodspus:[],
      colors:[],
      sorts:[],
      unitss:[]
    };
  },
  created() {
    this.list();
    this.listGoodSpus();
    this.listColor()
    this.listSort()
    this.listUnits()
  },
};
</script>

<style>
#div {
  margin-left: 300px;
  margin-bottom: 30px;
}
</style>